<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="$$rootcsspath$$">
  <style>
    .header {
      background-image: url("https://raw.githubusercontent.com/IBM/Developer-Playground/master/didact/images/video_insights.jpeg");
    }
  </style>
</head>
<body>
    <div style="margin-top:2rem"></div>
    <div id="workspaceID" class="hidden-state">$workspace_id</div>
    <div id="userID" class="hidden-state">$user_id</div>
    <div id="environment" class="hidden-state">development</div>
    <div class="header">
        <div class="left-content">
            <div class="apptitle">Self-service customizable CP4D environment setup</div>
            <div class="subheading">Cloud Pak for Data (CP4D) v4 adopted the Operator based installation & management pattern.
            This gives us flexibility to custom build a demo environment based on our needs. If we are doing a simple data
            science demo with services WS, WML you can choose to just install those 2 services in a self-service fashion on
            an appropriately sized cluster for more cost effectiveness in addition to better performance as you would have
            installed just services you need for your demo. This interface uses standard engineering-supported install
            utility/mechanism for ongoing support/maintainability.</div>
        </div>
    </div>
    <div class="section">
        <p style="font-size:24px">Pre-requisites</p>
        <div>
        <p>Configure Openshift credentials (either use combination of server, user/password (OR) server, token).<br>
            Openshift server name (including https://) and token can be obtained using one of two methods
        <ol>
            <li>From Openshift console, select your profile on top right and select “Copy login command”</li>
            <li>From oc cli, run “oc config view --minify|grep server” to get server name and “oc whoami -t” to get token
            </li>
        </ol>
        </p>
        <p>Obtain an Entitlement key from <a href="https://myibm.ibm.com/products-services/containerlibrary"> IBM Container Library</a> using your IBM ID. Click Get an entitlement key if you are not on the entitlement page.</p>
        <div class="env-config">
            <label>ICR Key: </label><input class="env-variables" name="icr_key" type="text" /><p></p><p></p>
            <label>Server: </label><input class="env-variables" name="server" type="text" />
            <label>API Token: </label><input class="env-variables" name="api_token" type="text" />
            <p>-------OR-------</p>
            <p></p>
            <label>Kube Admin User: </label><input class="env-variables" name="kubeadmin_user" type="text" />
            <label>Kube Admin Password: </label><input class="env-variables" name="kubeadmin_pass" type="password" />
        </div>
        </div>
    </div>
    <div class="section" style="margin-top:5rem;">
        <p style="font-size:24px">Instructions</p>
        <p>Please follow all the below steps in proper sequence.</p>
        <br>
        At a high level the installation steps include:
        <ol>
            <li>Configure CP deployer on Openshift cluster.</li>
            <li>Deploy selected CP4D services.</li>
        </ol>
        Please follow steps below as appropriate, some steps are optional depending on what needs to be done. Mandatory
        steps are indicated using *<br><br>
    </div>
    <div class="timeline-container">
        <input type="text" class="hidden-state" id="data-fetched" />
        <div class="timeline">
            <div class="content">
                <p>Get the resources required to deploy CP4D services and configure the openshift credentials.</p>
            </div>
            <button class="button is-dark is-medium" id="configure-env" title="Configure Environment" numSuccess=1>Configure Environment</button>
            <button id="configure-env$1" class="send-to-extension hidden-state" action="senddata" command=""
                nextAction="configure-env$2"></button><span class="spinner hidden-state"></span>
            <button id="configure-env$2" class="send-to-extension hidden-state" action="readfile"
                command="cd /projects/techzone-demo/olm-utils-v2;pip3.8 install pyYaml;python3.8 getInstalledServices.py cp4d"
                filePath="/projects/techzone-demo/olm-utils-v2/serviceList.json" preProcess="true"
                numSuccess=1 nextAction="enable-timeline"></button><span class="spinner hidden-state"></span>
            <button id="enable-timeline" class="hidden-state">Enable</button>
            <span class="dot"></span>
        </div>
        <div class="timeline">
        <div class="content">
                    <p>CP4D</p>
                <div style="padding: 1.5rem;">
                    <div class="content">
                        <p>Deploy custom resources for selected CP4D services</p>
                        <div class="env-config">
                            <label>CP4D Version</label>
                            <input type="text" id="cp4d_version" value="4.5.0">
                            <label>Components list
                            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
                            <div id="service-list" class="dropdown-check-list" tabindex="100">
                                <span class="anchor">Select Components</span>
                                <div class="items">
                                    <input id="services-search" type="search" placeholder="Search components" style="width: 100%" />
                                    <ul id="git-services">
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <p style="margin-top:1rem"><b>Selected Services: </b><span id="selected-services"></span></p>
                        <div class="env-config">
                            <b>Storage Vendor</b><br>
                            <div>
                                Valid values include:
                                <ul>
                                <li>nfs: If using NFS you should ensure that there is a storage class called managed-nfs-storage </li>
                                <li>ocs: If you are using OCS storage for CP4D </li>
                                <li>portworx: If you are using Portworx storage for CP4D </li>
                                <li>roks-classic: If you want to use ibmc-file-gold-gid and ibm-block-gold-gid </li>
                                <ul>
                            </div>
                            <label></label>
                            <select id="storage_value" style="width:150px;height:33px;padding-left: -150px">
                                <option value="nfs">nfs</option>
                                <option value="ocs">ocs</option>
                                <option value="portworx">portworx</option>
                                <option value="roks-classic">roks-classic</option>
                            </select>
                        </div>
                    </div>
                        <br /><br />
                    <button class="button is-dark is-medium" id="install_cpd" title="Execute" command="">Install selected services</button>
                    <button id="install_cpd$1" class="send-to-extension hidden-state" action="senddata" command="" numSuccess=2></button><span class="spinner hidden-state"></span>
                    <span class="dot"></span>
                    </div>
                </div>
            </div>
                    <div class="timeline">
                    <div class="content">
                    <p>Cleanup install utility artifacts</p>
                </div>
                <button class="send-to-extension button is-dark is-medium" id="clean-up-job" title="Clean up" command="cd /projects/techzone-demo/olm-utils-v2/;sh delete.sh" numSuccess=1>Clean up</button><span class="spinner hidden-state"></span>
                <span class="dot"></span>
        </div>
        </div>
    </div>
</body>
<script src="$$rootjspath$$"></script>
<script src="$$rootvscodeutilspath$$"></script>
</html>
